pipeline {

    agent any

    tools {
        jdk 'JDK 17'
        nodejs 'NodeJS 18'
    }


    environment {
        GITHUB_TOKEN = credentials("GITHUB_TOKEN")

    }

    stages {
         
        stage("display repositories") {
            steps {

             dir('reactApp/public/docs') {
                sh '''
                    npm install
                    npm i -g pm2
                    npm i -g tsx
                '''

                    sh "ls -alh"                
                    }
            }

        }
        stage("build") {
            steps {
            sh "sh ./jenkins/commands.sh ${GITHUB_TOKEN} java-test-repository"
            sh "ls -alh"
            dir('reactApp/public') {
                sh "ls -alh"
                }
            dir('reactApp/public/docs') {
                sh "ls -alh"
                }
            }

        }

                 
        stage("post-build") {
            steps {
                 sh "ls -alh"

                echo 'Starting the build Stage'
                dir('reactApp/') {
                sh "ls -alh"
                sh 'npm run deploy'

                }
            }
        }

    }

}

